<div class="container px-2">
  <div class="row">
    <div class="col-10 col-md-9 col-sm-9 mx-auto px-0 my-5">
      <div class="mx-3 mb-5"><h3 class="mini-title">コミュニティ詳細</h3></div>

      <table class="table">
        <tr>
          <td class="img" colspan="4">
            <%= image_tag @group.get_image, class: "show-img" %>
          </td>
        </tr>
        <tr>
          <td width="30%">コミュニティ名：</td>
          <td colspan="3"><%= @group.name %></td>
        </tr>
        <tr>
          <td width="30%">コミュニティ紹介：</td>
          <td height="80" colspan="3" style="white-space: pre-wrap;">
            <%= @group.introduction %>
          </td>
        </tr>
        <tr>
          <td width="30%">コミュニティ作成者：</td>
          <td colspan="2">
            <%= link_to @group.owner, class: "text-dark", style: "text-decoration:underline" do %>
              <%= image_tag @group.owner.get_profile_image, class: "rounded-circle icon-mini" %>
              <%= @group.owner.screen_name %>
            <% end %>
          </td>
          <td width="19%">
            <% if @group.is_owned_by?(current_user) %>
              <div class="actions">
                <%= link_to "編集", edit_group_path(@group), class: "btn btn-info" %>
              </div>
            <% end %>
          </td>
        </tr>
        <tr>
          <td width="30%">
            参加者(<%= @group_users.count %>人)：
          </td>
          <td colspan="3">
            <!-- 表示を20個に制限 -->
            <% @group_users.first(20).each do |user| %>
              <%= link_to user_path(user) do %>
                <%= image_tag user.get_profile_image, class: "group-user-icon rounded-circle" %>
              <% end %>
            <% end %>
          </td>
        </tr>
      </table>

      <div style="text-align: right">
        <% if @group.is_owned_by?(current_user) %>
          <%= link_to "チャット画面へ", room_path(@group), class: "btn btn-success" %>
        <% else %>
          <% if @group.includesUser?(current_user) %>
            <%= link_to "チャット画面へ", room_path(@group), class: "btn btn-success" %>
            <%= link_to "退会する", group_group_user_path(@group), method: :delete, data: {confirm: "退会してよろしいですか？"}, class: "btn btn-danger" %>
          <% else %>
            <%= link_to "参加する", group_group_user_path(@group), method: :post, data: {confirm: "コミュニティに参加しますか？"}, class: "btn btn-info" %>
          <% end %>
        <% end %>
      </div>

    </div>
  </div>
</div>
